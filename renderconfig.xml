<renderconfig>

    <var id="VAR_tileWidth" type="int">16</var>
    <var id="VAR_tileHeight" type="int">16</var>

    <rendertarget id="RT_depth">
        <format>D32_FLOAT</format>
    </rendertarget>

    <rendertarget id="RT_color">
        <format>R8G8B8A8_UNORM</format>
    </rendertarget>

    <rendertarget id="RT_tileLineCount">
        <format>R32_SINT</format>
        <!-- 16x16 tiles -->
        <width_div ref="VAR_tileWidth"/>
        <height_div ref="VAR_tileHeight"/>
    </rendertarget>


    <buffer id="BUF_tileBuffer">
        <!-- actual buffer size is determined by the element type in the shader -->
        <width_div ref="VAR_tileWidth"/>
        <height_div ref="VAR_tileHeight"/>
    </buffer>

    <render_state id="DSS_default">
        <depth_enable>true</depth_enable>
        <depth_write>true</depth_write>
        <depth_func>LESS</depth_func>
    </render_state>

    <sampler id="SMP_linear">
        <filter>MIN_MAG_MIP_LINEAR</filter>
        <address_u>WRAP</address_u>
        <address_v>WRAP</address_v>
        <address_w>WRAP</address_w>
    </sampler>

    <sampler id="SMP_point">
        <filter>MIN_MAG_MIP_POINT</filter>
        <address_u>WRAP</address_u>
        <address_v>WRAP</address_v>
        <address_w>WRAP</address_w>
    </sampler>

    <passes>
        <blit id="PBLIT_clear_tile_buffer">
            <fill_buffer buffer="BUF_tileBuffer" value="0"/>
        </blit>

        <mesh_shading id="PMESH_render_curves">
            <shader>
                <file>crates/fluff/shaders/curve_binning.glsl</file>
                <defines>
                    <define>
                        <name>NUM_TILES_X</name>
                        <value>16</value>
                    </define>
                </defines>
            </shader>

            <use_state ref="DSS_default"/>

            <color_output index="0">
                <target ref="RT_tileLineCount"/>
                <blend_enable>false</blend_enable>
                <clear>
                    <uint>0</uint>
                </clear>
            </color_output>

            <render_buffer index="0">
                <image ref="RT_tileLineCount"/>
                <clear_uint>0</clear_uint>
            </render_buffer>

        </mesh_shading>

    </passes>

</renderconfig>